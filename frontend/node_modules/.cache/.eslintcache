[{"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\index.js":"1","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\App.js":"2","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\Header.js":"3","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\context\\AuthContext.js":"4","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\utils\\ProtectedRoute.js":"5","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\MainApp.js":"6","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\HomePage.js":"7","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\LoginPage.js":"8","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\RegisterPage.js":"9","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\ChannelListContainer.js":"10","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\MainContainer.js":"11","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\context\\FriendContext.js":"12","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\FriendList.js":"13","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\Sidebar.js":"14","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\FriendRequestListContainer.js":"15","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\AddFriendContainer.js":"16","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\MessageContainer.js":"17","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\ConControls.js":"18"},{"size":250,"mtime":1689102107715,"results":"19","hashOfConfig":"20"},{"size":1029,"mtime":1697019444919,"results":"21","hashOfConfig":"20"},{"size":1004,"mtime":1690304206603,"results":"22","hashOfConfig":"20"},{"size":5936,"mtime":1697028303476,"results":"23","hashOfConfig":"20"},{"size":412,"mtime":1689100876600,"results":"24","hashOfConfig":"20"},{"size":545,"mtime":1689096982239,"results":"25","hashOfConfig":"20"},{"size":1995,"mtime":1696274509157,"results":"26","hashOfConfig":"20"},{"size":1378,"mtime":1690365751729,"results":"27","hashOfConfig":"20"},{"size":5096,"mtime":1697028759663,"results":"28","hashOfConfig":"20"},{"size":510,"mtime":1690391685414,"results":"29","hashOfConfig":"20"},{"size":1144,"mtime":1690401490871,"results":"30","hashOfConfig":"20"},{"size":1724,"mtime":1697028366727,"results":"31","hashOfConfig":"20"},{"size":781,"mtime":1690453647556,"results":"32","hashOfConfig":"20"},{"size":2772,"mtime":1697028701535,"results":"33","hashOfConfig":"20"},{"size":2945,"mtime":1697028534169,"results":"34","hashOfConfig":"20"},{"size":3605,"mtime":1697028459391,"results":"35","hashOfConfig":"20"},{"size":11803,"mtime":1697028675543,"results":"36","hashOfConfig":"20"},{"size":16993,"mtime":1690452668070,"results":"37","hashOfConfig":"20"},{"filePath":"38","messages":"39","suppressedMessages":"40","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1m3h4dg",{"filePath":"41","messages":"42","suppressedMessages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"44"},{"filePath":"45","messages":"46","suppressedMessages":"47","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"48"},{"filePath":"49","messages":"50","suppressedMessages":"51","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"52","messages":"53","suppressedMessages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"55","messages":"56","suppressedMessages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"58"},{"filePath":"59","messages":"60","suppressedMessages":"61","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"62","messages":"63","suppressedMessages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"65","messages":"66","suppressedMessages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"68","messages":"69","suppressedMessages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"71"},{"filePath":"72","messages":"73","suppressedMessages":"74","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"75"},{"filePath":"76","messages":"77","suppressedMessages":"78","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"79","messages":"80","suppressedMessages":"81","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"82"},{"filePath":"83","messages":"84","suppressedMessages":"85","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"86","messages":"87","suppressedMessages":"88","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"89","messages":"90","suppressedMessages":"91","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"92","messages":"93","suppressedMessages":"94","errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"95","messages":"96","suppressedMessages":"97","errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"98"},"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\index.js",[],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\App.js",["99","100"],[],"import './App.css';\r\nimport Header from './components/Header';\r\nimport AuthContext, { AuthProvider } from './context/AuthContext';\r\n\r\nimport { Routes, Route, HashRouter  as Router } from 'react-router-dom'\r\nimport ProtectedRoute from './utils/ProtectedRoute'\r\n\r\nimport HomePage from './pages/HomePage';\r\nimport LoginPage from './pages/LoginPage';\r\nimport MainApp from './pages/MainApp';\r\nimport RegisterPage from './pages/RegisterPage';\r\n\r\n\r\nfunction App() {\r\n  // let {user} = useContext(AuthContext)\r\n\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Router >\r\n        <AuthProvider>\r\n          <Routes>\r\n            <Route element={<HomePage />} path=\"/\"/>\r\n            <Route element={<LoginPage />} path=\"/login\"/>\r\n            <Route element={<RegisterPage />} path=\"/register\" />\r\n            <Route element={<ProtectedRoute />}>\r\n              <Route path='/test/*' element={<MainApp />} />\r\n            </Route>\r\n          </Routes>\r\n        </AuthProvider>\r\n      </Router>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\Header.js",["101"],[],"import React, {useContext} from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport AuthContext from '../context/AuthContext'\r\n\r\nconst Header = () => {\r\n  let {user, logoutUser} = useContext(AuthContext)\r\n  return (\r\n    <div className='bg-neutral-900 flex h-auto pl-28 pr-28 pt-5 pb-5 text-white'>\r\n        <Link to=\"/\" className='pl-3 pr-3 pt-1 hover:underline'>Ognik</Link>\r\n        {/* <a className='pl-3 pr-3 pt-1'>About</a> */}\r\n        <a className='pl-3 pr-3 pt-1 hover:underline' href='https://github.com/Snaczeek/Ognik'>Github</a>\r\n        {user ? (\r\n          <div className='ml-auto'><button className='header-button'><Link to=\"/test/friends\">Open ognik</Link></button></div>\r\n          ): (\r\n            <div className='ml-auto'><Link to=\"/login\"><button className='header-button'>Login</button></Link> </div>\r\n            )}\r\n\r\n        {/* {user && <h1>Hello {user.username}</h1>} */}\r\n        {/* <Link to=\"/register\">Register</Link> */}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Header\r\n","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\context\\AuthContext.js",["102"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\utils\\ProtectedRoute.js",[],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\MainApp.js",["103","104","105","106","107"],[],"import React, {useState, useEffect, useContext} from 'react'\r\nimport AuthContext from '../context/AuthContext'\r\nimport FriendContext, {FriendProvider} from '../context/FriendContext'\r\nimport ChannelListContainer from '../components/ChannelListContainer'\r\nimport MainContainer from '../components/MainContainer'\r\n\r\nconst MainApp = () => {\r\n \r\n  return (\r\n    <div className='MainApp'>\r\n      <FriendProvider>\r\n          <ChannelListContainer />\r\n          <MainContainer />\r\n      </FriendProvider>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MainApp\r\n","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\HomePage.js",[],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\LoginPage.js",[],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\pages\\RegisterPage.js",["108","109","110","111"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\ChannelListContainer.js",["112"],[],"import React from 'react'\r\nimport Sidebar from './Sidebar'\r\nimport FriendList from './FriendList'\r\nimport MainContainer from '../components/MainContainer'\r\n\r\nimport { Routes, Route } from 'react-router-dom'\r\n\r\n\r\nexport const ChannelListContainer = () => {\r\n  return (\r\n    <div className=\"inline-flex w-80 h-screen  bg-gray-800\">\r\n        <Sidebar />\r\n        <Routes>\r\n          <Route path=\"/friends/*\" element={<FriendList />} />\r\n        </Routes>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ChannelListContainer","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\MainContainer.js",["113","114","115"],[],"import React, {useContext, useState, useEffect} from 'react'\r\nimport MessageContainer from './MessageContainer'\r\nimport AddFriendContainer from './AddFriendContainer'\r\nimport FriendRequestListContainer from './FriendRequestListContainer'\r\n\r\nimport { Routes, Route } from 'react-router-dom'\r\nimport AuthContext from '../context/AuthContext'\r\nimport FriendContext from '../context/FriendContext'\r\nconst MainContainer = () => {\r\n  let {wsdata} = useContext(FriendContext)\r\n  // let {WebSocket} = useContext(AuthContext)\r\n  // let [messageWS, setMessageWS] = useState(null)\r\n\r\n  // WebSocket.onmessage = function (e) {\r\n  //   setMessageWS(e.data)\r\n  // }\r\n  // console.log(\"Main ws listener is working poggers\")\r\n  // console.log(messageWS)\r\n\r\n  return (\r\n    <div className='w-[85%] bg-gray-700'>\r\n      <Routes>\r\n        <Route path=\"/friends/mcon/:username\" element={<MessageContainer asd={wsdata}/>} />\r\n        <Route path=\"/friends/addFriend\" element={<AddFriendContainer />} />\r\n        <Route path=\"/friends/friendRequestList\" element={<FriendRequestListContainer />} />\r\n      </Routes>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MainContainer","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\context\\FriendContext.js",["116"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\FriendList.js",["117","118","119"],[],"import React, {useState, useEffect, useContext, createContext} from 'react'\r\nimport FriendContext from '../context/FriendContext'\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst FriendListContext = createContext();\r\n\r\nexport const FriendList = () => {\r\n\r\n    let {friends} = useContext(FriendContext)\r\n    let i = 0\r\n\r\n  return (\r\n    <div className='w-[75%] overflow-y-auto scrollbar'>\r\n      <Link to={\"./addFriend\"}><div className='add-friend-button'>Add Friend</div></Link>\r\n      <div className='text-center p-4 text-gray-500'>Friends list</div>\r\n      <div className=''>\r\n        {friends.map(f => (\r\n            <Link to={\"./mcon/\"+f} ><div key={i++}className='friend-container'>{f}</div></Link>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default FriendList","C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\Sidebar.js",["120","121","122","123"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\FriendRequestListContainer.js",["124","125","126","127"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\AddFriendContainer.js",["128"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\MessageContainer.js",["129","130","131","132","133","134"],[],"C:\\Users\\mateu\\Desktop\\OGNIK\\Ognik\\frontend\\src\\components\\ConControls.js",["135","136","137","138","139","140","141","142","143","144","145","146"],[],"import {React, useEffect, useContext, useState} from 'react'\r\nimport {  useParams } from \"react-router-dom\";\r\nimport CallIcon from \"../assets/phone-call.png\"\r\nimport CameraIcon from \"../assets/camera.png\"\r\nimport MicIcon from \"../assets/mic.png\"\r\nimport PhoneIcon from \"../assets/phone.png\"\r\nimport EndCall from \"../assets/end-call.png\"\r\nimport AuthContext from '../context/AuthContext'\r\n\r\nlet localStream;\r\nlet remoteStream;\r\nlet peerConnection\r\nlet isVisible = false\r\nlet is_in_call = false;\r\nlet friend_call = \"none\"\r\nlet isCalling = false\r\n\r\nconst ConControls = ({data = null, fcall}) => {\r\n    // Getting username from URL\r\n    let { username } = useParams();\r\n    let string = username.toString();\r\n\r\n    // const [isVisible, setIsVisible] = useState(false);\r\n\r\n    // Getting access to authToken and WebSocket info from AuthContext\r\n    let { WebSocket, authToken, user} = useContext(AuthContext)\r\n\r\n    // !!! prop for sending ice can using webSockets !!!\r\n    \r\n    // WebSocket.send(JSON.stringify({\r\n    //     'message': 'message was sent',\r\n    //     'friendName': string,\r\n    //     'type': 'init_call',\r\n    // }))\r\n\r\n\r\n\r\n    const servers = \r\n    {\r\n        iceServers:[\r\n            {\r\n                urls:['stun:stun.l.google.com:19302', 'stun:stun2.l.google.com:19302']\r\n            }\r\n        ]\r\n    } \r\n    \r\n\r\n    let setup_ui = async () => {\r\n        console.log(\"test1\")\r\n        // Getting UI element    \r\n        // let callBTN = document.getElementById(\"call-controls\");\r\n        let button = document.getElementById(\"ConControls-Call-icon\");\r\n        button.style.visibility = \"hidden\";\r\n        // Getting chat element\r\n        let chat = document.getElementsByClassName(\"message_container_chat\")[0];\r\n        let message_list = document.getElementsByClassName(\"message_list\")[0];\r\n        \r\n        // Getting video elemnt\r\n        let user1 = document.getElementById('user-1');\r\n        let user2 = document.getElementById('user-2');\r\n\r\n        // Getting permisson from the user\r\n        localStream = await navigator.mediaDevices.getUserMedia({video: true, audio: true}); // getting problem here\r\n\r\n        console.log('test2')\r\n\r\n        let video_container = document.getElementById(\"video_container\");\r\n        video_container.style.display = \"grid\"\r\n\r\n        // Setting up video container style\r\n        // callBTN.style.display = 'visible';\r\n        user1.style.visibility = 'visible';\r\n        user1.style.height = \"100%\";\r\n        user2.style.visibility = 'visible';\r\n        user2.style.height = \"100%\";\r\n        isVisible = true\r\n        // Setting up src stream for user 1\r\n        user1.srcObject = localStream;\r\n        \r\n        user1.onloadedmetadata = function(e) {\r\n            user1.play();\r\n        };\r\n\r\n        // uiNav.style.height = \"50vh\";\r\n        // chat.style.height = \"45vh\";\r\n        message_list.style.height = \"50vh\";\r\n\r\n        is_in_call = true;\r\n    }\r\n\r\n    // Changing layout of website\r\n    let init_call = async () =>\r\n    {\r\n        friend_call = string\r\n        setup_ui()\r\n\r\n        create_offer()\r\n        \r\n        // alert(\"ended\");\r\n    }\r\n\r\n    let createPeerConnection = async () => {\r\n        // Creating connection object\r\n        peerConnection = new RTCPeerConnection(servers)\r\n\r\n        // Creating friend's stream object\r\n        remoteStream = new MediaStream()\r\n        // Setting html video object to friend's stream\r\n        document.getElementById('user-2').srcObject = remoteStream;\r\n\r\n        if(!localStream){\r\n            localStream = await navigator.mediaDevices.getUserMedia({video:true, audio:true})\r\n            document.getElementById('user-1').srcObject = localStream\r\n        }\r\n\r\n        // For every track, tracks are added to localStream (user's stream)\r\n        localStream.getTracks().forEach((track) => {\r\n            peerConnection.addTrack(track, localStream)\r\n        })\r\n\r\n        // For every track from friend's peer connection, tracks are added to remoteStream (Friend's stream)\r\n        peerConnection.ontrack = (e) => {\r\n            e.streams[0].getTracks().forEach((track) => {\r\n                remoteStream.addTrack(track)\r\n            })\r\n        }\r\n\r\n        // Debuging\r\n        peerConnection.onicecandidate = async (e) => {\r\n            if(e.candidate){\r\n                // console.log('New ICE candidate: ', e.candidate)\r\n                WebSocket.send(JSON.stringify({\r\n                    'message': e.candidate,\r\n                    'friendName': string,\r\n                    'type': 'candidate',\r\n                }))\r\n            }\r\n        }\r\n    }\r\n\r\n    let create_offer = async () => \r\n    {\r\n        await createPeerConnection()\r\n\r\n        let offer = await peerConnection.createOffer()\r\n        // sets local descirpiton and also fires of peerConnection.onicecandidate listener\r\n        await peerConnection.setLocalDescription(offer)\r\n\r\n        const delay = ms => new Promise(\r\n            resolve => setTimeout(resolve, ms)\r\n        );\r\n        await delay(400)\r\n\r\n        WebSocket.send(JSON.stringify({\r\n            'message': offer,\r\n            'friendName': string,\r\n            'type': 'init_call',\r\n        }))\r\n        // console.log('Offer: ', offer)\r\n        // console.log(peerConnection)\r\n    }\r\n\r\n    let create_answer = async (offer) => {\r\n        await createPeerConnection()\r\n\r\n        await peerConnection.setRemoteDescription(offer)\r\n\r\n        let answer = await peerConnection.createAnswer()\r\n        await peerConnection.setLocalDescription(answer)\r\n\r\n        // console.log(string)\r\n        console.log(\"asnwer: |\")\r\n        console.log(answer)\r\n        // creating delay to ensure that aswer is created before sending message\r\n        // if not first init of the call wont work :( (I have absolutely no idea how to fix this)\r\n        const delay = ms => new Promise(\r\n            resolve => setTimeout(resolve, ms)\r\n        );\r\n        await delay(1000)\r\n        WebSocket.send(JSON.stringify({\r\n            'message': answer,\r\n            'friendName': string,\r\n            'type': 'answer',\r\n        }))\r\n\r\n    }\r\n\r\n    let addAnswer = async (answer) => {\r\n        // console.log(\"tests: \")\r\n        // console.log(peerConnection)\r\n        if (!peerConnection.currentRemoteDescription) {\r\n            // console.log(peerConnection) \r\n            console.log(peerConnection.currentRemoteDescription)\r\n            // count++\r\n            await peerConnection.setRemoteDescription(answer);\r\n        }\r\n      };\r\n\r\n    let handleCallFromPeer = async (data) => {\r\n        // quick delay hack (not working in this case :( i hate life )\r\n        // const delay = ms => new Promise(\r\n        //     resolve => setTimeout(resolve, ms)\r\n        // );\r\n        // await delay(300)\r\n        if (data)\r\n        {\r\n            // Debuggin stuff\r\n            // if (data.friend == string)\r\n            // {\r\n                // console.log(data)\r\n            // }\r\n            // If data is type init_call and was send from a friend\r\n            if (data.type == \"init_call\" && data.friend == string)\r\n            {\r\n                // Setting flag that will fire off ui calling prompt\r\n                isCalling = true\r\n                // Getting accept_call button and adding event listener onclick \r\n                // that will fire of createReqeust function with passed 'data' param\r\n                let button = document.getElementById(\"call_request_accept_call\")\r\n                button.addEventListener(\"click\", createRequest)\r\n                button.myParam = data\r\n            }\r\n            \r\n            if (data.message.type === \"answer\" && data.friend == string)\r\n            {\r\n                // Adding answer\r\n                addAnswer(data.message)\r\n                // console.log(\"add_answer\")\r\n                // console.log(data.message)\r\n            }\r\n            \r\n            if (data.type == \"candidate\" && data.friend == string)\r\n            {\r\n                // creating delay hack to ensure that create_answer() sends answer object first via websocket\r\n                // possible fix:\r\n                // create system where peer has to accept call and this will ensure time buffer betweem adding Ice Candidates and receiving answer object\r\n                // answer object must be received before adding any Ice Candidates if not Ice Candidates on peer side will be added to null local description (that will throw error)\r\n                const delay = ms => new Promise(\r\n                    resolve => setTimeout(resolve, ms)\r\n                );\r\n                await delay(1000)\r\n                console.log(\"ice tests\")\r\n                if(peerConnection){\r\n                    console.log(peerConnection.remoteDescription)\r\n                    peerConnection.addIceCandidate(data.message)\r\n\r\n                    console.log(\"addIceCandidate\")\r\n                }\r\n            }\r\n\r\n            if (data.type == \"end_call\" && is_in_call && friend_call == data.friend)\r\n            {\r\n                handleUserLeft()\r\n            }\r\n        }\r\n\r\n        // isCalling(false)\r\n    }\r\n    \r\n    // Creating positive answer to call \r\n    let createRequest = async (data) => {\r\n\r\n        // Saving friend name that user is in call with to var\r\n        friend_call = data.currentTarget.myParam.friend\r\n        // Changing ui \r\n        setup_ui()\r\n        // Creating answer ice object and sending it to a peer \r\n        create_answer(data.currentTarget.myParam.message)\r\n        \r\n        // Making ui call request disappear\r\n        isCalling = false\r\n    }\r\n\r\n    // TO FIX: object stream bug, in new call\r\n    let handleUserLeft = async () => {\r\n        \r\n        // Getting html element\r\n        let uiNav = document.getElementsByClassName(\"ConControls\")[0];\r\n        // Getting whole div that contains input message and list message\r\n        let chat = document.getElementsByClassName(\"message_container_chat\")[0];\r\n        // Getting list that contains messages\r\n        let message_list = document.getElementsByClassName(\"message_list\")[0];\r\n\r\n        // Changing back height setting\r\n        uiNav.style.height = \"auto\";\r\n        chat.style.height = \"auto\";\r\n        // Setting message list to 85% of website height\r\n        message_list.style.height = \"85vh\";\r\n        \r\n        // Getting html call button (green button that init the call)\r\n        let button = document.getElementById(\"ConControls-Call-icon\");\r\n        // Making button visible again\r\n        button.style.visibility = \"visible\";\r\n        \r\n        // Making div that contains video objects invisible\r\n        let video_container = document.getElementById(\"video_container\");\r\n        video_container.style.display = \"none\"\r\n        \r\n        // Getting users video objects\r\n        let user1 = document.getElementById('user-1');\r\n        let user2 = document.getElementById('user-2');\r\n        \r\n        // Making them also invinsible \r\n        user1.style.visibility = 'hidden';\r\n        user1.style.height = \"0%\";\r\n        user2.style.visibility = 'hidden';\r\n        user2.style.height = \"0%\";\r\n        \r\n        // Setting flags to false\r\n        isVisible = false\r\n        is_in_call = false\r\n        isCalling = false\r\n        \r\n        // Testing/debuggin/fixing bugs\r\n\r\n        // localStream.getTracks().forEach((track) => {\r\n            //     track.stop();\r\n            // })\r\n\r\n        // For every track, tracks are added to localStream (user's stream)\r\n        \r\n    \r\n        // console.log(peerConnection.getSenders())\r\n        // peerConnection.removeTrack(peerConnection.getSenders()[0])\r\n\r\n        // let videoTrack = localStream.getTracks().find(track => track.kind === 'video')\r\n        // localStream.getTracks().forEach((track) => {\r\n        //     console.log(track)\r\n        //     // track.stop();\r\n        //     localStream.removeTrack(track)\r\n        // })\r\n\r\n        // closing peer connection (sets connection to 'close' status, it doesn't destroying connection)\r\n        peerConnection.close()\r\n        // Temporary fix to object stream bug\r\n        window.location.reload()\r\n        // removeTrack()\r\n        \r\n        // Sending to peer 'end_call' prompt\r\n        WebSocket.send(JSON.stringify({\r\n            'message': 'end call',\r\n            'friendName': string,\r\n            'type': 'end_call',\r\n        }))\r\n    }\r\n\r\n    // Denying incoming call\r\n    let deny_call = () => {\r\n        isCalling = false\r\n\r\n        // Sending to peer 'end_call' prompt \r\n        WebSocket.send(JSON.stringify({\r\n            'message': 'end call',\r\n            'friendName': string,\r\n            'type': 'end_call',\r\n        }))\r\n    }\r\n\r\n    // Toggle user's stream camera\r\n    let toggle_camera = async () => {\r\n        // Getting user's stream object\r\n        let videoTrack = localStream.getTracks().find(track => track.kind === 'video')\r\n\r\n        if (videoTrack.enabled)\r\n        {\r\n            // Disabling video src\r\n            videoTrack.enabled = false\r\n            // Setting background color of button to red\r\n            document.getElementById('camera_btn').style.backgroundColor = 'rgb(255, 80, 80)'\r\n        }\r\n        else\r\n        {\r\n            // Enabling video src\r\n            videoTrack.enabled = true\r\n            // Setting background color of button to blue\r\n            document.getElementById('camera_btn').style.backgroundColor = 'rgb(102, 153, 255, .8)'\r\n        }\r\n    }\r\n\r\n    // Taggle user's stream audio\r\n    let toggle_audio = async () => {\r\n        // Getting user's stream object\r\n        let audioTrack = localStream.getTracks().find(track => track.kind === 'audio')\r\n\r\n        if (audioTrack.enabled)\r\n        {\r\n            // Disabling audio src\r\n            audioTrack.enabled = false\r\n            // Changing button background to red\r\n            document.getElementById('mic_btn').style.backgroundColor = 'rgb(255, 80, 80)'\r\n        }\r\n        else\r\n        {\r\n            // Enabling audio src\r\n            audioTrack.enabled = true\r\n            // Changing button background to blue\r\n            document.getElementById('mic_btn').style.backgroundColor = 'rgb(102, 153, 255, .8)'\r\n        }\r\n    }\r\n    \r\n    \r\n    useEffect(()=> {\r\n        // Adding event listenr that checks if user refreshed/close tab\r\n        window.addEventListener('beforeunload', handleUserLeft)\r\n        // if(is_in_call === true)\r\n        // {\r\n        //     init_call()\r\n        // }\r\n        // else\r\n        // {\r\n        //     // Getting UI element    \r\n        //     let uiNav = document.getElementsByClassName(\"ConControls\")[0];\r\n        //     // Getting chat element\r\n        //     let chat = document.getElementsByClassName(\"message_container_chat\")[0];\r\n        //     let message_list = document.getElementsByClassName(\"message_list\")[0];\r\n        //     uiNav.style.height = \"auto\";\r\n        //     chat.style.height = \"auto\";\r\n        //     message_list.style.height = \"85vh\";\r\n        // }\r\n        // // setup_ui()\r\n\r\n        // setIsVisible(false)\r\n    }, [])\r\n\r\n    // Logic for handling incoming call from ws\r\n    handleCallFromPeer(data)\r\n    \r\n    return (\r\n        <div className='main_uivideo_con'>\r\n            <div className='ConControls'>\r\n                <div id='ConControls-friendname'>{username}</div>\r\n                <div id='ConControls-Call-icon' onClick={init_call}><img src={CallIcon} alt=\"call\"/></div>\r\n            </div>\r\n            <div className='video_container' id='video_container' hidden>\r\n                <video className=\"video-player\" id='user-1' autoPlay playsInline ></video>\r\n                <video className=\"video-player\" id='user-2' autoPlay playsInline ></video>\r\n            </div>\r\n            <div className={isCalling ? 'visible' : 'hidden'} id='call_request'>\r\n                <div id='call_request_text'>\r\n                    {string} is calling you!\r\n                </div>\r\n                <div id='call_request_controls'>\r\n                    <div className='control-container' id='call_request_accept_call'>\r\n                        <img src={PhoneIcon} alt='accept_call' />\r\n                    </div>\r\n                    <div className='control-container' id='leave_btn' onClick={deny_call}>\r\n                        <img src={EndCall} alt='deny_call'/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={isVisible ? 'visible' : 'hidden'} id='call_controls'>\r\n                <div className=\"control-container\" id=\"camera_btn\" onClick={toggle_camera}>\r\n                    <img src={CameraIcon} alt='camera_btn' />\r\n                </div>\r\n                <div className=\"control-container\" id=\"mic_btn\" onClick={toggle_audio}>\r\n                    <img src={MicIcon} alt='microphone_btn' />\r\n                </div>\r\n                <div className=\"control-container\" id=\"leave_btn\" onClick={handleUserLeft}>\r\n                    <img src={PhoneIcon} alt='leave_btn' />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ConControls",{"ruleId":"147","severity":1,"message":"148","line":2,"column":8,"nodeType":"149","messageId":"150","endLine":2,"endColumn":14},{"ruleId":"147","severity":1,"message":"151","line":3,"column":8,"nodeType":"149","messageId":"150","endLine":3,"endColumn":19},{"ruleId":"147","severity":1,"message":"152","line":6,"column":14,"nodeType":"149","messageId":"150","endLine":6,"endColumn":24},{"ruleId":"153","severity":1,"message":"154","line":156,"column":8,"nodeType":"155","endLine":156,"endColumn":39,"suggestions":"156"},{"ruleId":"147","severity":1,"message":"157","line":1,"column":16,"nodeType":"149","messageId":"150","endLine":1,"endColumn":24},{"ruleId":"147","severity":1,"message":"158","line":1,"column":26,"nodeType":"149","messageId":"150","endLine":1,"endColumn":35},{"ruleId":"147","severity":1,"message":"159","line":1,"column":37,"nodeType":"149","messageId":"150","endLine":1,"endColumn":47},{"ruleId":"147","severity":1,"message":"151","line":2,"column":8,"nodeType":"149","messageId":"150","endLine":2,"endColumn":19},{"ruleId":"147","severity":1,"message":"160","line":3,"column":8,"nodeType":"149","messageId":"150","endLine":3,"endColumn":21},{"ruleId":"147","severity":1,"message":"161","line":18,"column":15,"nodeType":"149","messageId":"150","endLine":18,"endColumn":28},{"ruleId":"162","severity":1,"message":"163","line":52,"column":28,"nodeType":"164","messageId":"165","endLine":52,"endColumn":30},{"ruleId":"162","severity":1,"message":"166","line":73,"column":24,"nodeType":"164","messageId":"165","endLine":73,"endColumn":26},{"ruleId":"162","severity":1,"message":"166","line":82,"column":24,"nodeType":"164","messageId":"165","endLine":82,"endColumn":26},{"ruleId":"147","severity":1,"message":"167","line":4,"column":8,"nodeType":"149","messageId":"150","endLine":4,"endColumn":21},{"ruleId":"147","severity":1,"message":"157","line":1,"column":28,"nodeType":"149","messageId":"150","endLine":1,"endColumn":36},{"ruleId":"147","severity":1,"message":"158","line":1,"column":38,"nodeType":"149","messageId":"150","endLine":1,"endColumn":47},{"ruleId":"147","severity":1,"message":"151","line":7,"column":8,"nodeType":"149","messageId":"150","endLine":7,"endColumn":19},{"ruleId":"153","severity":1,"message":"168","line":49,"column":8,"nodeType":"155","endLine":49,"endColumn":10,"suggestions":"169"},{"ruleId":"147","severity":1,"message":"157","line":1,"column":16,"nodeType":"149","messageId":"150","endLine":1,"endColumn":24},{"ruleId":"147","severity":1,"message":"158","line":1,"column":26,"nodeType":"149","messageId":"150","endLine":1,"endColumn":35},{"ruleId":"147","severity":1,"message":"170","line":5,"column":7,"nodeType":"149","messageId":"150","endLine":5,"endColumn":24},{"ruleId":"147","severity":1,"message":"171","line":2,"column":8,"nodeType":"149","messageId":"150","endLine":2,"endColumn":16},{"ruleId":"147","severity":1,"message":"172","line":3,"column":8,"nodeType":"149","messageId":"150","endLine":3,"endColumn":18},{"ruleId":"147","severity":1,"message":"173","line":4,"column":8,"nodeType":"149","messageId":"150","endLine":4,"endColumn":25},{"ruleId":"153","severity":1,"message":"174","line":51,"column":10,"nodeType":"155","endLine":51,"endColumn":12,"suggestions":"175"},{"ruleId":"147","severity":1,"message":"176","line":1,"column":49,"nodeType":"149","messageId":"150","endLine":1,"endColumn":57},{"ruleId":"147","severity":1,"message":"177","line":36,"column":9,"nodeType":"149","messageId":"150","endLine":36,"endColumn":17},{"ruleId":"147","severity":1,"message":"177","line":51,"column":9,"nodeType":"149","messageId":"150","endLine":51,"endColumn":17},{"ruleId":"153","severity":1,"message":"174","line":63,"column":6,"nodeType":"155","endLine":63,"endColumn":8,"suggestions":"178"},{"ruleId":"147","severity":1,"message":"158","line":1,"column":26,"nodeType":"149","messageId":"150","endLine":1,"endColumn":35},{"ruleId":"162","severity":1,"message":"166","line":57,"column":53,"nodeType":"164","messageId":"165","endLine":57,"endColumn":55},{"ruleId":"153","severity":1,"message":"179","line":92,"column":22,"nodeType":"149","endLine":92,"endColumn":29},{"ruleId":"153","severity":1,"message":"180","line":96,"column":6,"nodeType":"155","endLine":96,"endColumn":16,"suggestions":"181"},{"ruleId":"162","severity":1,"message":"163","line":118,"column":53,"nodeType":"164","messageId":"165","endLine":118,"endColumn":55},{"ruleId":"162","severity":1,"message":"166","line":188,"column":14,"nodeType":"164","messageId":"165","endLine":188,"endColumn":16},{"ruleId":"162","severity":1,"message":"166","line":192,"column":19,"nodeType":"164","messageId":"165","endLine":192,"endColumn":21},{"ruleId":"147","severity":1,"message":"157","line":1,"column":39,"nodeType":"149","messageId":"150","endLine":1,"endColumn":47},{"ruleId":"147","severity":1,"message":"182","line":26,"column":22,"nodeType":"149","messageId":"150","endLine":26,"endColumn":31},{"ruleId":"147","severity":1,"message":"183","line":26,"column":33,"nodeType":"149","messageId":"150","endLine":26,"endColumn":37},{"ruleId":"147","severity":1,"message":"184","line":55,"column":13,"nodeType":"149","messageId":"150","endLine":55,"endColumn":17},{"ruleId":"162","severity":1,"message":"166","line":213,"column":27,"nodeType":"164","messageId":"165","endLine":213,"endColumn":29},{"ruleId":"162","severity":1,"message":"166","line":213,"column":57,"nodeType":"164","messageId":"165","endLine":213,"endColumn":59},{"ruleId":"162","severity":1,"message":"166","line":224,"column":63,"nodeType":"164","messageId":"165","endLine":224,"endColumn":65},{"ruleId":"162","severity":1,"message":"166","line":232,"column":27,"nodeType":"164","messageId":"165","endLine":232,"endColumn":29},{"ruleId":"162","severity":1,"message":"166","line":232,"column":57,"nodeType":"164","messageId":"165","endLine":232,"endColumn":59},{"ruleId":"162","severity":1,"message":"166","line":251,"column":27,"nodeType":"164","messageId":"165","endLine":251,"endColumn":29},{"ruleId":"162","severity":1,"message":"166","line":251,"column":70,"nodeType":"164","messageId":"165","endLine":251,"endColumn":72},{"ruleId":"153","severity":1,"message":"185","line":423,"column":8,"nodeType":"155","endLine":423,"endColumn":10,"suggestions":"186"},"no-unused-vars","'Header' is defined but never used.","Identifier","unusedVar","'AuthContext' is defined but never used.","'logoutUser' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'updateToken'. Either include it or remove the dependency array.","ArrayExpression",["187"],"'useState' is defined but never used.","'useEffect' is defined but never used.","'useContext' is defined but never used.","'FriendContext' is defined but never used.","'passwordError' is assigned a value but never used.","eqeqeq","Expected '!==' and instead saw '!='.","BinaryExpression","unexpected","Expected '===' and instead saw '=='.","'MainContainer' is defined but never used.","React Hook useEffect has a missing dependency: 'getFriends'. Either include it or remove the dependency array.",["188"],"'FriendListContext' is assigned a value but never used.","'HomeIcon' is defined but never used.","'LogoutIcon' is defined but never used.","'FriendRequestIcon' is defined but never used.","React Hook useEffect has a missing dependency: 'getFriendRequest'. Either include it or remove the dependency array.",["189"],"'Navigate' is defined but never used.","'response' is assigned a value but never used.",["190"],"The ref value 'containerRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'containerRef.current' to a variable inside the effect, and use that variable in the cleanup function.","React Hook useEffect has missing dependencies: 'getMessages', 'removeFromStorage', 'string', and 'updates'. Either include them or remove the dependency array.",["191"],"'authToken' is assigned a value but never used.","'user' is assigned a value but never used.","'chat' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'handleUserLeft'. Either include it or remove the dependency array.",["192"],{"desc":"193","fix":"194"},{"desc":"195","fix":"196"},{"desc":"197","fix":"198"},{"desc":"197","fix":"199"},{"desc":"200","fix":"201"},{"desc":"202","fix":"203"},"Update the dependencies array to be: [authToken, loading, WebSocket, updateToken]",{"range":"204","text":"205"},"Update the dependencies array to be: [getFriends]",{"range":"206","text":"207"},"Update the dependencies array to be: [getFriendRequest]",{"range":"208","text":"209"},{"range":"210","text":"209"},"Update the dependencies array to be: [getMessages, removeFromStorage, string, updates, username]",{"range":"211","text":"212"},"Update the dependencies array to be: [handleUserLeft]",{"range":"213","text":"214"},[5631,5662],"[authToken, loading, WebSocket, updateToken]",[1513,1515],"[getFriends]",[1640,1642],"[getFriendRequest]",[1970,1972],[3183,3193],"[getMessages, removeFromStorage, string, updates, username]",[14978,14980],"[handleUserLeft]"]