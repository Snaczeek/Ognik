{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{createContext,useState,useEffect,useContext}from'react';import AuthContext from'../context/AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";var FriendContext=/*#__PURE__*/createContext();export default FriendContext;export var FriendProvider=function FriendProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),friends=_useState2[0],setFriends=_useState2[1];var _useContext=useContext(AuthContext),authToken=_useContext.authToken,WebSocket=_useContext.WebSocket;var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),wsdata=_useState4[0],setWsdata=_useState4[1];WebSocket.onmessage=function(e){var data=JSON.parse(e.data);console.log(data);setWsdata(data);// console.log(wsdata)\nif(data.type===\"friendRequest\"){getFriends();window.location.reload();}};var getFriends=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data,new_data,i;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('http://localhost:8000/users/friends/',{method:\"GET\",headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authToken.access)}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;new_data=[];// pushing only username's to new array\nfor(i=0;i<data[0].friends.length;i++){// console.log(\"test: \" + data[0].friends[i].username + \" \" + i);\nnew_data.push(data[0].friends[i].username);}setFriends(new_data);case 9:case\"end\":return _context.stop();}},_callee);}));return function getFriends(){return _ref2.apply(this,arguments);};}();useEffect(function(){getFriends();},[]);var contextData={friends:friends,wsdata:wsdata};return/*#__PURE__*/_jsx(FriendContext.Provider,{value:contextData,children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","AuthContext","FriendContext","FriendProvider","children","friends","setFriends","authToken","WebSocket","wsdata","setWsdata","onmessage","e","data","JSON","parse","console","log","type","getFriends","window","location","reload","fetch","method","headers","String","access","response","json","new_data","i","length","push","username","contextData"],"sources":["C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/src/context/FriendContext.js"],"sourcesContent":["import React from 'react'\r\nimport { createContext, useState, useEffect, useContext } from 'react';\r\nimport AuthContext from '../context/AuthContext'\r\n\r\n\r\nconst FriendContext = createContext();\r\n\r\nexport default FriendContext\r\n\r\nexport const FriendProvider = ({children}) => {\r\n    let [friends, setFriends] = useState([])\r\n    let {authToken, WebSocket} = useContext(AuthContext) \r\n    let [wsdata, setWsdata] = useState()  \r\n\r\n    WebSocket.onmessage = (e) => {\r\n        let data = JSON.parse(e.data)\r\n        console.log(data)\r\n        setWsdata(data)\r\n        // console.log(wsdata)\r\n        if(data.type === \"friendRequest\")\r\n        {\r\n            getFriends()\r\n            window.location.reload()\r\n        }\r\n    }\r\n\r\n    let getFriends = async () =>{\r\n        let response = await fetch('http://localhost:8000/users/friends/', {\r\n            method: \"GET\",\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Authorization':'Bearer ' + String(authToken.access)\r\n            }\r\n        })\r\n\r\n        let data = await response.json()\r\n        let new_data = []\r\n        \r\n        // pushing only username's to new array\r\n        for (let i = 0; i < data[0].friends.length; i++) {\r\n            // console.log(\"test: \" + data[0].friends[i].username + \" \" + i);\r\n            new_data.push(data[0].friends[i].username)\r\n        }\r\n        setFriends(new_data)\r\n    }\r\n\r\n    useEffect(() => {\r\n        getFriends()\r\n    }, [])\r\n\r\n    let contextData = {\r\n        friends:friends,\r\n        wsdata:wsdata\r\n    }\r\n\r\n  return (\r\n    <FriendContext.Provider value={contextData}>\r\n        {children}\r\n    </FriendContext.Provider>\r\n  )\r\n}\r\n"],"mappings":"mZAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OAASC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACtE,MAAOC,YAAW,KAAM,wBAAwB,4CAGhD,GAAMC,cAAa,cAAGL,aAAa,EAAE,CAErC,cAAeK,cAAa,CAE5B,MAAO,IAAMC,eAAc,CAAG,QAAjBA,eAAc,MAAmB,IAAdC,SAAQ,MAARA,QAAQ,CACpC,cAA4BN,QAAQ,CAAC,EAAE,CAAC,wCAAnCO,OAAO,eAAEC,UAAU,eACxB,gBAA6BN,UAAU,CAACC,WAAW,CAAC,CAA/CM,SAAS,aAATA,SAAS,CAAEC,SAAS,aAATA,SAAS,CACzB,eAA0BV,QAAQ,EAAE,yCAA/BW,MAAM,eAAEC,SAAS,eAEtBF,SAAS,CAACG,SAAS,CAAG,SAACC,CAAC,CAAK,CACzB,GAAIC,KAAI,CAAGC,IAAI,CAACC,KAAK,CAACH,CAAC,CAACC,IAAI,CAAC,CAC7BG,OAAO,CAACC,GAAG,CAACJ,IAAI,CAAC,CACjBH,SAAS,CAACG,IAAI,CAAC,CACf;AACA,GAAGA,IAAI,CAACK,IAAI,GAAK,eAAe,CAChC,CACIC,UAAU,EAAE,CACZC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CAC5B,CACJ,CAAC,CAED,GAAIH,WAAU,6FAAG,uLACQI,MAAK,CAAC,sCAAsC,CAAE,CAC/DC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAC,CACJ,cAAc,CAAC,kBAAkB,CACjC,eAAe,CAAC,SAAS,CAAGC,MAAM,CAACnB,SAAS,CAACoB,MAAM,CACvD,CACJ,CAAC,CAAC,QANEC,QAAQ,qCAQKA,SAAQ,CAACC,IAAI,EAAE,QAA5BhB,IAAI,eACJiB,QAAQ,CAAG,EAAE,CAEjB;AACA,IAASC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGlB,IAAI,CAAC,CAAC,CAAC,CAACR,OAAO,CAAC2B,MAAM,CAAED,CAAC,EAAE,CAAE,CAC7C;AACAD,QAAQ,CAACG,IAAI,CAACpB,IAAI,CAAC,CAAC,CAAC,CAACR,OAAO,CAAC0B,CAAC,CAAC,CAACG,QAAQ,CAAC,CAC9C,CACA5B,UAAU,CAACwB,QAAQ,CAAC,sDACvB,kBAlBGX,WAAU,2CAkBb,CAEDpB,SAAS,CAAC,UAAM,CACZoB,UAAU,EAAE,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,GAAIgB,YAAW,CAAG,CACd9B,OAAO,CAACA,OAAO,CACfI,MAAM,CAACA,MACX,CAAC,CAEH,mBACE,KAAC,aAAa,CAAC,QAAQ,EAAC,KAAK,CAAE0B,WAAY,UACtC/B,QAAQ,EACY,CAE7B,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}