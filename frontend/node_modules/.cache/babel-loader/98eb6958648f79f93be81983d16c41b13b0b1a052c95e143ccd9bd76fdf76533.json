{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from'react';import AuthContext from'../context/AuthContext';import FriendContext from'../context/FriendContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddFriendContainer=function AddFriendContainer(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useContext=useContext(AuthContext),WebSocket=_useContext.WebSocket,authToken=_useContext.authToken;var _useContext2=useContext(FriendContext),friends=_useContext2.friends;// friend_search\nvar getUesrs=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var username,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();// alert(document.getElementById('friend_search').value);\nusername=document.getElementById('friend_search').value;_context.next=4;return fetch('http://localhost:8000/users/friendrequest/getUsers/'+username,{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authToken.access)}});case 4:response=_context.sent;_context.next=7;return response.json();case 7:data=_context.sent;setUsers(data);console.log(Object.keys(data));if(Object.keys(data).length===0){// console.log(\"worky\")\ndocument.getElementById(\"friend_text\").innerHTML=\"Account not found\";}else{document.getElementById(\"friend_text\").innerHTML=\"\";}case 11:case\"end\":return _context.stop();}},_callee);}));return function getUesrs(_x){return _ref.apply(this,arguments);};}();var sendFriendRequest=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(username){var response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:// ToDo Send Friend request using http post and websocket\nalert(username);//  friendrequest/sendFriendRequest/<str:friendName>\n_context2.next=3;return fetch('http://localhost:8000/users/friendrequest/sendFriendRequest/'+username,{method:'GET',headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authToken.access)}});case 3:response=_context2.sent;_context2.next=6;return response.json();case 6:data=_context2.sent;console.log(data.status);if(data.status===\"already exist\"){alert(\"Friend request was already sended\");}else{// Sending message to websocket (so that receivee can see friend request apear in real time)\nWebSocket.send(JSON.stringify({'friendName':username,'type':'friend_request'}));}case 9:case\"end\":return _context2.stop();}},_callee2);}));return function sendFriendRequest(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"friendadd_container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"friend_header_container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"You can add friends by searching their username\"}),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:getUesrs,className:\"friend_search\",autoComplete:\"off\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"friend_search\",placeholder:\"username\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Search\"})]})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"friendadd_list\",children:users.map(function(user){return/*#__PURE__*/_jsxs(\"div\",{className:\"friend_container\",children:[/*#__PURE__*/_jsx(\"text\",{className:\"friend_container_username\",children:user.username}),friends.includes(user.username)?/*#__PURE__*/_jsx(\"text\",{className:\"friend_container_UFWTP\",children:\"You're friends with this person\"}):/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return sendFriendRequest(user.username);},children:\"Send Friend Request\"})]});})})]});};export default AddFriendContainer;","map":{"version":3,"names":["React","useState","useEffect","useContext","AuthContext","FriendContext","AddFriendContainer","users","setUsers","WebSocket","authToken","friends","getUesrs","e","preventDefault","username","document","getElementById","value","fetch","method","headers","String","access","response","json","data","console","log","Object","keys","length","innerHTML","sendFriendRequest","alert","status","send","JSON","stringify","map","user","includes"],"sources":["C:/Users/mateu/Desktop/OGNIK/Ognik/frontend/src/components/AddFriendContainer.js"],"sourcesContent":["import React, {useState, useEffect, useContext} from 'react'\r\nimport AuthContext from '../context/AuthContext'\r\nimport FriendContext from '../context/FriendContext'\r\n\r\nconst AddFriendContainer = () => {\r\n\r\n    let [users, setUsers] = useState([])\r\n    let { WebSocket, authToken} = useContext(AuthContext)\r\n    let {friends} = useContext(FriendContext)\r\n    // friend_search\r\n    let getUesrs = async (e) => {\r\n        e.preventDefault();\r\n        // alert(document.getElementById('friend_search').value);\r\n        let username = document.getElementById('friend_search').value\r\n        let response = await fetch('http://localhost:8000/users/friendrequest/getUsers/'+ username, {\r\n            method: 'GET',\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Authorization':'Bearer ' + String(authToken.access)\r\n            },\r\n        })\r\n        let data = await response.json()\r\n        setUsers(data)\r\n        console.log(Object.keys(data))\r\n        if (Object.keys(data).length === 0){\r\n            // console.log(\"worky\")\r\n            document.getElementById(\"friend_text\").innerHTML = \"Account not found\"\r\n        } \r\n        else{\r\n            document.getElementById(\"friend_text\").innerHTML = \"\"\r\n        }\r\n    }\r\n\r\n    let sendFriendRequest = async (username) => {\r\n        // ToDo Send Friend request using http post and websocket\r\n        alert(username)\r\n\r\n        //  friendrequest/sendFriendRequest/<str:friendName>\r\n        let response = await fetch('http://localhost:8000/users/friendrequest/sendFriendRequest/'+ username, {\r\n            method: 'GET',\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Authorization':'Bearer ' + String(authToken.access)\r\n            },\r\n        })\r\n        let data = await response.json()\r\n        console.log(data.status)\r\n        if (data.status === \"already exist\"){\r\n            alert(\"Friend request was already sended\")\r\n        }\r\n        else\r\n        {\r\n            // Sending message to websocket (so that receivee can see friend request apear in real time)\r\n            WebSocket.send(JSON.stringify({\r\n                'friendName': username,\r\n                'type': 'friend_request',\r\n            }))\r\n        }\r\n    }\r\n\r\n\r\n  return (\r\n    <div className='friendadd_container'>\r\n        <div className='friend_header_container'>\r\n            <h1>You can add friends by searching their username</h1> <br/>\r\n            <form onSubmit={getUesrs} className=\"friend_search\" autoComplete=\"off\"> \r\n                <input type=\"text\" id=\"friend_search\" placeholder=\"username\"/>\r\n                <button type=\"submit\">Search</button>\r\n            </form>\r\n        </div>\r\n            \r\n        <ul className=\"friendadd_list\">\r\n            {/* <p1 id=\"friend_text\">Looking for a friend?</p1> */}\r\n            {users.map(user => (\r\n                <div className=\"friend_container\">\r\n                    <text className='friend_container_username'>{user.username}</text>\r\n                    {friends.includes(user.username) ? (\r\n                        <text className=\"friend_container_UFWTP\">You're friends with this person</text>\r\n                    ): (\r\n                        <button onClick={() => sendFriendRequest(user.username)}>Send Friend Request</button>\r\n                    )}\r\n                    \r\n                </div>\r\n            ))}\r\n        </ul>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AddFriendContainer"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}